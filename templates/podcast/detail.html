{% extends "base.html" %}

{% block title %}{{ item.title }}{% endblock %}

{% block content %}
  <h1>{{ item.title }}</h1>
  <p>{{ item.description }}</p>

  <button id="play">دریافت لینک پخش</button>
  <audio id="player" controls></audio>

  <script>
    document.getElementById('play').addEventListener('click', async () => {
      const r = await fetch(window.location.pathname + 'stream-url/');
      const j = await r.json();
      if (j.url) {
        const audio = document.getElementById('player');
        audio.src = j.url; // presigned / CDN
        audio.play();
      } else {
        alert('فایلی یافت نشد');
      }
    });
  </script>
{% endblock %}
