'use client';import {useState} from 'react';import {api} from '../../lib/api';export default function LoginPage(){const[identifier,setIdentifier]=useState('');const[step,setStep]=useState('enter');const[code,setCode]=useState('');const[info,setInfo]=useState(null);const[error,setError]=useState(null as any);const requestOtp=async()=>{setError(null);setInfo(null);if(!identifier.trim()){setError('ایمیل یا شماره موبایل را وارد کنید');return;}try{await api('POST','/auth/request-otp',{identifier});setStep('code');setInfo('کد OTP در لاگ کانتینر backend چاپ شده است.')}catch(e:any){setError('ارتباط با بک‌اند برقرار نشد. ' + (e?.message||''))}};const verifyOtp=async()=>{setError(null);setInfo(null);if(!code.trim()){setError('کد را وارد کنید');return;}try{const{token}=await api('POST','/auth/verify-otp',{identifier,code});localStorage.setItem('quran_token',token);setStep('done');setInfo('ورود انجام شد!')}catch(e:any){setError(e.message||'کد نامعتبر است')}};return(<main><h1>ورود</h1>{info&&<div className='alert'>{info}</div>}{error&&<div className='alert' style={{borderColor:'#a33'}}>❌ {String(error)}</div>}{step==='enter'&&(<div className='form'><input className='input' placeholder='ایمیل یا شماره موبایل' value={identifier} onChange={e=>setIdentifier(e.target.value)}/><button className='button' onClick={requestOtp}>درخواست کد</button></div>)}{step==='code'&&(<div className='form'><input className='input' placeholder='کد ۶ رقمی' value={code} onChange={e=>setCode(e.target.value)}/><div className='row'><button className='button' onClick={verifyOtp}>تأیید کد</button><button className='button' onClick={requestOtp}>ارسال دوباره</button></div></div>)}{step==='done'&&(<div style={{marginTop:12}}><a className='button' href='/profile'>رفتن به پروفایل</a></div>)}</main>) }